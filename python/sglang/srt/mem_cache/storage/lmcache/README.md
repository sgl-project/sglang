# LMCache Connector for SGLang

This document describes how to use LMCache as KV Cache Management Backend for SGLang engine.
For more details about LMCache, please refer to: https://lmcache.ai

## Install LMCache

### Method 1: with pip

```bash
pip install lmcache
```

### Method 2: from source

Clone LMCache project:

```bash
git clone https://github.com/LMCache/LMCache
```

Install:

```bash
cd LMCache
pip install -e . --no-build-isolation
```

## Use LMCache

Firstly, setup LMCache config. An example config is set at `example_config.yaml`. For more settings please refer to https://docs.lmcache.ai/api_reference/configurations.html.

Secondly, setup SGLang serving engine with LMCache:

```bash
export LMCACHE_CONFIG_FILE=example_config.yaml

python -m sglang.launch_server \
  --model-path MODEL \
  --enable-lmcache
```

## Publish KV Events from LMCache

LMCache can be enabled to generate KV cache events during storage operations.
KV Events can help KV-cache-aware routing make more efficient decisions, based on not only KV caches in GPU, but also KV caches in CPU, local disk and other storage medium.

Firstly, you need to set the configuration property `enable_kv_events` to `true` for LMCache, as events are not generated by default.

Secondly, the events need to be published. This requires configuring SGLang to publish the events it receives from LMCache. This requires configuring the SGLang configuration property `--kv-events-config`.

Finally, setup SGLang serving engine with LMCache as follows:

```bash
export LMCACHE_CONFIG_FILE=example_config.yaml # Don't forget to enable `enable_kv_events`

python -m sglang.launch_server \
  --model-path MODEL \
  --enable-lmcache \
  --kv-events-config '{"publisher": "zmq", "topic": "kv-events"}'
```
